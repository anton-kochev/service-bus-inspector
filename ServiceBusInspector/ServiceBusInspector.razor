@using global::ServiceBusInspector.Components
@using RazorConsole.Components
@using Spectre.Console
@using Align = RazorConsole.Components.Align
@using Markup = RazorConsole.Components.Markup

<Align Horizontal="HorizontalAlignment.Center">
    <Markdown Content="SERVICE BUS INSPECTOR"></Markdown>
</Align>

<Panel>
    <Align Horizontal="@HorizontalAlignment.Center">
        <Markup Content="Tab to change focus • Enter to submit • Ctrl+C to exit" Foreground="@Color.Grey58"/>
    </Align>

    <!-- Navigation and Actions -->
    <Align Horizontal="HorizontalAlignment.Center">
        <Panel Border="BoxBorder.Rounded">
            <TextButton Content="Peek messages" OnClick="@OnPeekMessages"
                        FocusedColor="Color.Yellow"/>
            <Markup Content=" | "></Markup>
            <TextButton Content="Reset queue" OnClick="@OnResetQueue"
                        FocusedColor="Color.Yellow"/>
            <Markup Content=" | "></Markup>
            <TextButton Content="Change queue" OnClick="@OnChangeQueue"
                        FocusedColor="Color.Yellow"/>
        </Panel>
    </Align>

    <!-- Message Queue Display -->
    <Grid Expand="true" Columns="2">
        <MessageListPanel Title="@($"{AppOptions.QueueName}")"
                          Messages="@State.MainQueueMessages"
                          ErrorMessage="@State.PeekError"
                          OnMessageSelected="@OnMessageSelected"/>

        <MessageListPanel Title="Dead Letter Queue"
                          Messages="@State.DeadLetterQueueMessages"
                          ErrorMessage="@State.PeekError"
                          OnMessageSelected="@OnMessageSelected"/>
    </Grid>

    <!-- Message Details -->
    <MessageDetailsTable Message="@State.SelectedMessage"/>

    <!-- Footer -->
</Panel>

<!-- Status Messages -->
<StatusMessageDisplay WarningMessage="@State.WarningMessage"
                      SuccessMessage="@State.SuccessMessage"/>

<Align Horizontal="HorizontalAlignment.Right">
    <Markup Content="@($"Current Time (UTC): {DateTime.UtcNow:yyyy-MM-dd HH:mm:ss}")" Foreground="@Color.Grey58"/>
</Align>
